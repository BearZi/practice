<!doctype html>
<html>
<style type="text/css">
	ul {
		list-style: none;
		position: relative;
	}
	li {
		display: block;
		position: absolute;
		transition: left 0.7s;
	}
	li img {
		width: 100%;
		display: block;
	}
</style>



<body>
	<ul>
		<li><img src="./public/images/1.jpg"/></li>
		<li><img src="./public/images/2.jpg"/></li>
		<li><img src="./public/images/7.jpg"/></li>
		<li><img src="./public/images/3.jpg"/></li>
		<li><img src="./public/images/6.jpg"/></li>
		<li><img src="./public/images/4.jpg"/></li>
		<li><img src="./public/images/5.jpg"/></li>
		<li><img src="./public/images/2.jpg"/></li>
		<li><img src="./public/images/6.jpg"/></li>
		<li><img src="./public/images/7.jpg"/></li>
	</ul>


<script type="text/javascript">
	var all_img = document.querySelectorAll('li > img'),
		all_li = document.querySelectorAll('li'),
		img_leng = all_img.length,
		check_img_load = 0,
		block_width = 200,
		record,
		prev_height,
		prev_pos_top,
		one_line_count,
		window_width,
		interval = 10,
		PosImg = function(){
			window_width = document.documentElement.clientWidth;
			one_line_count = Math.floor(window_width/block_width);

			for (var i=0; i < img_leng; i++) {
				//all_li[i].style.cssText = 'width:30%';
				all_li[i].style.width = block_width + 'px';

				if (!i) {
					all_li[i].style.top = 0;
					all_li[i].style.left= 0;
					block_width = all_li[i].offsetWidth;
				} else if (i%one_line_count > 0) {
					if (record == Math.floor(i/one_line_count)) {
						if (!record) {
							all_li[i].style.top = 0;
						} else {
							prev_height = all_li[i-one_line_count].offsetHeight;
							prev_pos_top = all_li[i-one_line_count].offsetTop;

							all_li[i].style.top = (prev_height + prev_pos_top +interval) + 'px';
						}
						all_li[i].style.left = ((block_width + interval)*(i%one_line_count)) + 'px';
					}
				} else {
					all_li[i].style.left = 0;

					prev_height = all_li[i-one_line_count].offsetHeight;
					prev_pos_top = all_li[i-one_line_count].offsetTop;

					all_li[i].style.top = (prev_height + prev_pos_top +interval) + 'px';
				}
				record = Math.floor(i/one_line_count);
			}
			console.log(block_width);
		};

	for (var i=0; i < img_leng; i++) {
		all_img[i].addEventListener('load', function (){
			check_img_load++;
			if (check_img_load === img_leng) {
				console.log('img loaded complete!!');

				PosImg();
				window.addEventListener('resize', PosImg, false);
			}
		}, false);
	}


</script>

</body>
</html>



